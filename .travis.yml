language: go

go:
  - 1.12.x

addons:
  postgresql: "9.6"

install:
  - make prepare

services:
  - postgresql

jobs:
  include:
    - stage: "Tests"
      name: "Unit Tests"
      script:        
        - make precommit2
        - goveralls -coverprofile profile.cov -service=travis-ci
        - kill %1
    - stage: "Tests"
      name: "Other Integration Tests"
      script:        
        - make precommit
        - goveralls -coverprofile profile.cov -service=travis-ci
        - kill %1
    - stage: "Tests"
      name: "Resources Integration Tests"
      script:
        - make precommit3
        - goveralls -coverprofile profile.cov -service=travis-ci
        - kill %1

notifications:
  slack: openservicebrokerapi:KQo2QAC6LXeEeXPOemOXja48
